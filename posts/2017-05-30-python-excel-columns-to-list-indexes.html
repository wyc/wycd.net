<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>wyc - Excel Columns to List Indexes in Python</title>
		<link rel="stylesheet" href="../css/default.css" />
		<link rel="stylesheet" href="../css/syntax.css" />
	</head>
	<body>
    <header>
      <h1>wyc's domain</h1>
      <ul>
        <li><a href="https://github.com/wyc" target="_blank">
            <img src="../images/github.png" alt="GitHub">
        </a></li>
        <li><a href="https://www.linkedin.com/in/changwayne" target="_blank">
            <img src="../images/linkedin.png" alt="LinkedIn">
        </a></li>
        <li><a href="https://twitter.com/wycdd" target="_blank">
            <img src="../images/twitter.png" alt="Twitter">
        </a></li>
      </ul>
    </header>
    <nav>
      <a href="../">Home</a> |
      <a href="../blog.html">Blog</a> |
      <a href="../projects.html">Projects</a> |
      <a target="_blank" href="https://www.wyc.io/">Consulting</a>
    </nav>
		<hr />
    <content>
      <h2>Excel Columns to List Indexes in Python</h2>
      <div class="info">
    Posted on May 30, 2017
    
</div>

<div class="info">
    
    Tags: <a href="../tags/python.html">python</a>
    
</div>

<p>I was working on some CSV files for a project. I figured that it would be easier to refer to the columns by their Excel column letters (e.g., ‘A’, ‘B’, ‘AA’, ‘AZ’) than the column numbers.</p>
<p>Some clear benefits:</p>
<ul>
<li>I could refer to the column by how it appeared under LibreOffice, making changes easier than matching the exact header string or zero-based numbering, both error-prone approaches for me.</li>
<li>Non-technical team members will know what I’m talking about, as opposed to “Column 0”</li>
</ul>
<p>The snippet is here for anyone who would find it helpful.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> to_idx(letters):
    val <span class="op">=</span> <span class="kw">lambda</span> i, x: (<span class="dv">26</span><span class="op">**</span>i) <span class="op">*</span> (<span class="bu">ord</span>(x.lower()) <span class="op">-</span> <span class="bu">ord</span>(<span class="st">'a'</span>) <span class="op">+</span> <span class="dv">1</span>)
    <span class="cf">return</span> <span class="bu">sum</span>([val(i, x) <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(letters[::<span class="op">-</span><span class="dv">1</span>])]) <span class="op">-</span> <span class="dv">1</span></code></pre></div>
<p>Here it is in action:</p>
<pre><code>    &gt;&gt;&gt; to_idx('A')
    0
    &gt;&gt;&gt; to_idx('AH')
    33
    &gt;&gt;&gt; to_idx('XFD')
    16383</code></pre>

    </content>
    <hr />
		<footer>
      <small>
      Site powered by
      <a href="http://jaspervdj.be/hakyll" target="_blank">Hakyll</a>.

      What I'm up to 
      <a href="../now.html">now</a>.
      <!--
      and
      <a href="https://www.nginx.com" target="_blank">nginx</a>.
      --></small>
		</footer>
  </body>
</html>
